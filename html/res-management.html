<!DOCTYPE html>
<html lang="en" style="font-size: 10px; font-family: Roboto, Arial, sans-serif; background-color: #FAFAFA">
<head>
    <meta charset="UTF-8">
    <title>V-Management</title>
    <script src="../js/jquery-3.3.1.js"></script>
    <script src="../js/common.js"></script>
</head>

<link rel="stylesheet" type="text/css" href="../css/index.css">
<script>

    var RELATIVE_PATH_PREFIX = "../../";
    var COUNT_PER_PAGE = 60;

    var currentNoTagVideosPageNumber = 0;
    var currentDeletedVideosPageNumber = 0;

    function listNoTagVideos() {

        $.ajax({
            crossDomain: true,
            url: "http://localhost:8880/information",
            data: {type: "video-list", query_type: "none"},
            method: "GET",
            dataType: "json",
            success: function (data) {
                if (data.code == 0) {
                    noTagVideoList = data.data;
                    showNoTagVideos(0);
                }
            }
        });
    }

    function showNoTagVideos(pageNumber) {

        currentNoTagVideosPageNumber = pageNumber;

        var noTagVideoDiv = "";
        for (var i = currentNoTagVideosPageNumber * COUNT_PER_PAGE; i < noTagVideoList.length && i < currentNoTagVideosPageNumber * COUNT_PER_PAGE + COUNT_PER_PAGE; i++) {
            noTagVideoDiv = noTagVideoDiv + genVideoItem(noTagVideoList[i], noTagVideoList);
        }
        document.getElementById("no-tag-videos").innerHTML = noTagVideoDiv;
        document.getElementById("title-no-tag-videos").innerHTML = `&nbsp;&nbsp;NO TAG VIDEOS (${noTagVideoList.length})`;
        document.getElementById("no-tag-videos-page-controller").innerHTML = getPageControllerDiv(noTagVideoList.length, COUNT_PER_PAGE, showNoTagVideos, currentNoTagVideosPageNumber, 'no-tag-videos');
    }

    function listDeletedVideos() {

        $.ajax({
            crossDomain: true,
            url: "http://localhost:8880/information",
            data: {type: "deleted-video-list"},
            method: "GET",
            dataType: "json",
            success: function (data) {
                if (data.code == 0) {
                    deletedVideoList = data.data;
                    showDeletedVideos(0);
                }
            }
        });
    }

    function showDeletedVideos(pageNumber) {

        currentDeletedVideosPageNumber = pageNumber;

        var deletedVideoDiv = "";
        for (var i = COUNT_PER_PAGE * currentDeletedVideosPageNumber; i < deletedVideoList.length && i < COUNT_PER_PAGE * currentDeletedVideosPageNumber + COUNT_PER_PAGE; i++) {
            deletedVideoDiv = deletedVideoDiv + genVideoItem(deletedVideoList[i], deletedVideoList);
        }

        document.getElementById("deleted-videos").innerHTML = deletedVideoDiv;
        document.getElementById("title-deleted-videos").innerHTML = `&nbsp;&nbsp;DELETED VIDEOS (${deletedVideoList.length})`
        document.getElementById("deleted-videos-page-controller").innerHTML = getPageControllerDiv(deletedVideoList.length, COUNT_PER_PAGE, showDeletedVideos, currentDeletedVideosPageNumber, 'deleted-videos');
    }

    function genVideoItem(object, videoList) {
        var isHd = ``;
        var durationStr = genDurationStr(object.duration_ms);
        var resolution = object.width + "x" + object.height
        if (object.width >= 480 && object.height >= 480) {
            isHd = `<b><i>HD</i></b>&ensp;`;
        }

        var url;
        if (videoList == noTagVideoList) {
            url = `javascript: playNoTagVideo(${object.id})`;
        } else if (videoList == deletedVideoList) {
            url = `javascript: playDeletedVideo(${object.id})`;
        }

        var video =

            // <div class="v-desc">
            //     <span class="icon-resolution"/>&ensp;${resolution}&ensp;&ensp;<span class="icon-view"/>&ensp;${object.view_count}&ensp;&ensp;
            // </div>
            //
            // <div class="v-title">
            //     ${object.title}
            // </div>
            `<a href="${url}" style="text-decoration: none" onmouseenter="loadImage('${object.md5}', '${RELATIVE_PATH_PREFIX + object.gif}')" onmouseleave="loadImage('${object.md5}', '${RELATIVE_PATH_PREFIX + object.jpg}')">
                <div class="v-item">
                    <div class="v-container">
                        <img src="${RELATIVE_PATH_PREFIX + object.jpg}" class="v-thumbnail" id="${object.md5}" style="object-fit: ${getThumbnailFitType(object.width, object.height)}; background: ${getThumbnailBackground(object.width, object.height)};" />
                        <span class="v-duration"><b>${isHd}${durationStr}</b></span>
                    </div>
                </div>
             </a>`
        return video;
    }

    function playNoTagVideo(videoId) {
        playVideo(videoId, noTagVideoList);
    }

    function playDeletedVideo(videoId) {
        playVideo(videoId, deletedVideoList);
    }

</script>
<body style="overflow-y: scroll">

<table align="center" width="90%" border="0px">
    <tr>
        <td>
            <div class='tag-title' id="title-no-tag-videos">&nbsp;&nbsp;NO TAG VIDEOS</div>
            <div id="no-tag-videos" style="display: block"></div>
            <div id="no-tag-videos-page-controller" style="display: block" align="center"></div>

            <div class='tag-title' id="title-deleted-videos">&nbsp;&nbsp;DELETED VIDEOS</div>
            <div id="deleted-videos" style="display: block"></div>
            <div id="deleted-videos-page-controller" style="display: block" align="center"></div>
        </td>
    </tr>
</table>
</body>
<script>
    var noTagVideoList = []
    var deletedVideoList = []

    listNoTagVideos();
    listDeletedVideos();
</script>
</html>